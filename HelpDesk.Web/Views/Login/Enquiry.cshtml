@model HelpDesk.Web.Models.UserDTO

@{
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Enquiry</title>
    <link href="~/assets/css/login.css" rel="stylesheet" />
    <link href="~/assets/plugins/global/plugins.bundle.css" rel="stylesheet" />
    <link href="~/assets/css/style.bundle.css" rel="stylesheet" />
    <link href="~/assets/css/Styles.css" rel="stylesheet" />
    <style>
        .select2-selection__rendered {
            background: rgba(247, 247, 249, 0.7);
            height: 50px;
            line-height: 35px !important;
        }

        .select2-container--default .select2-selection--multiple, .select2-container--default .select2-selection--single {
            border: none
        }

        .input-group-prepend {
            margin-top: 1.25rem;
        }

        .input-group-text {
            border: none;
        }
    </style>
    <style>
        .load-sec {
            background-color: rgba(255,255,255,0.6);
            position: fixed;
            top: 0px;
            right: 0px;
            bottom: 0px;
            left: 0;
            z-index: 99;
        }

        .loader span {
            position: relative;
            display: inline-block;
            width: 5px;
            height: 0;
            margin: 0;
            padding: 0;
        }

            .loader span:before, .loader span:after {
                position: absolute;
                content: '';
                height: 2px;
                width: 5px;
                background-color: #c0392b;
                animation: top 2s infinite;
            }

            .loader span:before {
                bottom: 0;
                height: 2px;
                width: 5px;
                border-top-left-radius: 3px;
                border-top-right-radius: 3px;
            }

            .loader span:after {
                top: 0;
                height: 2px;
                width: 5px;
                border-bottom-left-radius: 3px;
                border-bottom-right-radius: 3px;
            }

            .loader span:nth-of-type(1):before, .loader span:nth-of-type(1):after {
                max-height: 10px;
                background-color: #03C9A9;
            }

            .loader span:nth-of-type(2):before, .loader span:nth-of-type(2):after {
                max-height: 20px;
                background-color: #03C9A9;
            }

            .loader span:nth-of-type(3):before, .loader span:nth-of-type(3):after {
                max-height: 30px;
                background-color: #03C9A9;
            }

            .loader span:nth-of-type(4):before, .loader span:nth-of-type(4):after {
                max-height: 20px;
                background-color: #03C9A9;
            }

            .loader span:nth-of-type(5):before, .loader span:nth-of-type(5):after {
                max-height: 10px;
                background-color: #03C9A9;
            }

        @@keyframes top {
            0% {
                height: 2px;
            }

            50% {
                height: 30px;
            }

            100% {
                height: 2px;
            }
        }

        @@keyframes bottom {
            0% {
                height: 2px;
            }

            50% {
                height: 30px;
            }

            100% {
                height: 2px;
            }
        }

        @@keyframes pulsate {
            0% {
                transform: scale(1, 1);
                opacity: 0.0;
                letter-spacing: 0px;
            }

            50% {
                opacity: 1.0;
            }

            100% {
                transform: scale(1.1, 1.1);
                opacity: 0.05;
                letter-spacing: 5px;
            }
        }

        #div_mobileNumber1 input.input-group-text {
            width: 60px;
            border-right: 1px solid #727476;
        }

        #div_mobileNumber1.input-group .form-control:focus {
            border-left: 1px solid #dce1e5;
        }
    </style>


</head>
<body class="kt-page--loading-enabled kt-page--loading kt-header--fixed kt-header--minimize-topbar kt-header-mobile--fixed kt-quick-panel--right kt-demo-panel--right kt-offcanvas-panel--right kt-subheader--enabled kt-subheader--transparent kt-page--loading">
    <div id="loader" class="load-sec">
        <div class="loader">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>
    <!-- begin::Page loader -->
    <!-- end::Page Loader -->
    <!-- begin:: Page -->
    <div class="kt-grid kt-grid--ver kt-grid--root kt-page">
        <div class="kt-grid kt-grid--hor kt-grid--root  kt-login kt-login--v1" id="kt_login">
            <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--desktop kt-grid--ver-desktop kt-grid--hor-tablet-and-mobile">

                <!--begin::Aside-->
                <div class="kt-grid__item kt-grid__item--order-tablet-and-mobile-2 kt-grid kt-grid--hor kt-login__aside" style="background-image: url(http://208.109.10.196/AHCHelpdesk/assets/images/Login-Background-Image.jpg);">
                    <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--ver kt-padding-t-100-desktop">
                        <div class="kt-grid__item kt-grid__item--top">
                            <h3 class="h1 text-white kt-font-bold fa-3x"><strong>Welcome to<br /> AHC Help Desk!</strong></h3>
                            <h3 class="text-secondary kt-font-regular my-0">
                                Customer Service, Our Top Priority!
                            </h3>
                        </div>
                    </div>
                    <div class="kt-grid__item d_none_1024">
                        <div class="kt-login__info">
                            <div class="kt-login__copyright text-white text-center">
                                &copy 2021 Arabian Health Care.
                            </div>
                            <div class="kt-login__menu text-white">
                                Powered By <a href="https://www.creative-sols.com/" target="_blank" class="kt-link">Creative Solutions</a>
                            </div>
                            @*<div class="kt-login__menu">
                                    <a href="#" class="kt-link">Privacy</a>
                                    <a href="#" class="kt-link">Legal</a>
                                    <a href="#" class="kt-link">Contact</a>
                                </div>*@
                        </div>
                    </div>
                </div>
                <div class="kt-grid__item kt-grid__item--fluid  kt-grid__item--order-tablet-and-mobile-1  kt-login__wrapper">
                    <div class="kt-login__body">
                        <div class="kt-login__form">
                            <div class="kt-login__title">
                                <img src="~/assets/images/ahc_new_logo.png" height="50" class="mb-3" />
                                <h3>Enquiry</h3>
                            </div>
                            <form class="kt-form" action="" novalidate="novalidate" id="kt_login_form">
                                <div class="form-group mt-4">
                                        <select class="form-control kt-select2" id="ddlEnquiryType">
                                            <option value="Maintenance">Maintenance</option>
                                            <option value="Contract">Contract</option>
                                            <option value="Product Enquiry">Product Enquiry</option>
                                            <option value="Help Desk">Help Desk</option>
                                            <option value="Other">Other</option>
                                        </select>
                                </div>
                                <div class="form-group mt-4">
                                    <input class="form-control" type="text" value="" placeholder="Enter Company/Hospital Name" id="txtcompanyname">
                                </div>
                                <div class="form-group mt-4">
                                    <div id="Products_div">
                                        <select class="form-control kt-select2" id="ddlProducts" onchange="productchange()"></select>
                                    </div>
                                </div>
                                <div id="div_productname" class="form-group mt-4" style="display:none;">
                                    <input class="form-control" type="text" value="" placeholder="Enter Product Name" id="txtproductname">
                                </div>

                                <div class="form-group mt-4">
                                    <input class="form-control" type="text" value="" placeholder="Enter Full Name" id="txtCustomerName">
                                </div>
                                <div class="form-group mt-4">
                                    <input class="form-control" type="text" value="" placeholder="Enter Email" id="txtEmail">
                                </div>
                                <div class="form-group mt-4">
                                    <div id="div_mobileNumber1" class="input-group">
                                        <div class="input-group-prepend">
                                            <input type="text" id="txtcountrycode" class="input-group-text" maxlength="3" value="966" onkeypress="return isNumberKey(event)" />
                                        </div>
                                        <input class="form-control" autocomplete="off" type="text" value="" placeholder="xxx xxx xxxx" id="txtmobile" onkeypress="return isNumberKey(event)" onchange="mobilevalidation()">
                                    </div>
                                    <div id="div_mobileNumber"></div>
                                </div>
                                <div class="form-group mt-4">
                                    <textarea id="txtEnquiry" placeholder="Enter Enquiry" class="form-control" rows="8"></textarea>
                                </div>
                              
                                <div class="kt-login__actions">
                                    <a href="#" onclick="SaveEnquiryDetails()" class="btn bg-secondery pt-3 btn-elevate kt-login__btn-primary">Submit</a>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!--end::Body-->
                </div>
                <!--end::Content-->
            </div>
        </div>
    </div>
    <input type="hidden" id="hdnRoleId" value="@Model.RoleId" />
    <input type="hidden" id="hdnCompanyId" value="@Model.CompanyId" />
    <input type="hidden" id="hdnMobileValidation" value="0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/7.2.0/sweetalert2.min.css">

    <script src="~/assets/plugins/global/plugins.bundle.js"></script>
    <script src="~/assets/js/scripts.bundle.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/7.2.0/sweetalert2.all.min.js"></script>
    <script src="~/assets/js/select2.js"></script>
    <script>

 document.getElementById("loader").style.display = "none";
 $(document).ready(function () {
     //set initial state. 'Success',
                     'You clicked the <b style="color:green;">Success</b> button!',
                     'success'
     $('#ddlProducts,#ddlEnquiryType').select2({
     });
     if ($('#hdnRoleId').val() != 501) {
         BindProducts();
     }
 });

        function SaveEnquiryDetails() {
            document.getElementById("loader").style.display = "block";
            var isvalid = true;

            var EnquiryType = $("#ddlEnquiryType option:selected").text();
            if (EnquiryType == "") {
                isvalid = false;
                $('#txtenqurytypeerror').html('');
                $("#ddlEnquiryType").after('<span id="txtenqurytypeerror" style="color:red;" class="error">Field required.</span>');
            }
            else {
                $('#txtenqurytypeerror').html('');
            }
            var CompanyName = $("#txtcompanyname").val();
            if (CompanyName == "") {
                isvalid = false;
                $('#txtCompanyNameerror').html('');
                $("#txtcompanyname").after('<span id="txtCompanyNameerror" style="color:red;" class="error">Field required.</span>');
            }
            else {
                $('#txtCompanyNameerror').html('');
            }
            var PName = "";
            var Products = $("#ddlProducts").val();
            if (Products == "" || Products=="0") {
                isvalid = false;
                $('#txtproductserror').html('');
                $("#Products_div").after('<span id="txtproductserror" style="color:red;" class="error">Field required.</span>');
            }
            else {
                $('#txtproductserror').html('');
                if (Products == 'other') {
                    var OtherProductName = $('#txtproductname').val();
                    if (OtherProductName == "") {
                        isvalid = false;
                        $('#txttxtproductnameerror').html('');
                        $("#txtproductname").after('<span id="txttxtproductnameerror" style="color:red;" class="error">Field required.</span>');
                    }
                    else {
                        $('#txttxtproductnameerror').html('');
                        PName = OtherProductName;
                    }
                }
                else {
                    PName = $("#ddlProducts option:selected").text();
                }
            }
            var CustomerName = $("#txtCustomerName").val();
            if (CustomerName == "") {
                isvalid = false;
                $('#txtCustomerNameerror').html('');
                $("#txtCustomerName").after('<span id="txtCustomerNameerror" style="color:red;" class="error">Field required.</span>');
            }
            else {
                $('#txtCustomerNameerror').html('');
            }
            var Email = $("#txtEmail").val();
            if (Email == "") {
                isvalid = false;
                $('#txtEmailerror').html('');
                $("#txtEmail").after('<span id="txtEmailerror" style="color:red;" class="error">Field required.</span>');
            }
            else {
                $('#txtEmailerror').html('');
            }
            var Mobile = $("#txtmobile").val();
            if (Mobile == "") {
                isvalid = false;
                $('#txtmobilexxerror').html('');
                $("#div_mobileNumber").after('<span id="txtmobilexxerror" style="color:red;" class="error">Field required.</span>');
            }
            else {
                $('#txtmobilexxerror').html('');
            }
            var countrycode = $("#txtcountrycode").val();
            if (countrycode == "") {
                isvalid = false;
                $('#txtmobilexxerror').html('');
                $("#div_mobileNumber").after('<span id="txtmobilexxerror" style="color:red;" class="error">country code required.</span>');
            }
            else {
                $('#txtmobilexxerror').html('');
            }
            var Enquiry = $("#txtEnquiry").val();
            if (Enquiry == "" || Enquiry == null) {
                isvalid = false;
                $('#txtEnquiryerror').html('');
                $("#txtEnquiry").after('<span id="txtEnquiryerror" style="color:red;" class="error">Field required.</span>');
            }
            else {
                $('#txtEnquiryerror').html('');
            }
            if (isvalid == true) {
            //AJAX CALL 
                 $.ajax({
                    type: 'POST',
                    url: '@Url.Action("NewMainEnquiry")', // we are calling json method
                    dataType: 'json',
                    data: {
                        EnquiryType: EnquiryType, Enquiry: Enquiry, CustomerName: CustomerName, CustomerEmail: Email, CustomerPhone: countrycode + '-' + Mobile, CompanyName: CompanyName, ProductName: PName 
                        , ProductId: Products
                    },
                      success: function (data) {
                          document.getElementById("loader").style.display = "none";
                        swal('Success',
                            'we will contact you soon',
                            'success')
                            .then((value) => {
                                
                            });
                          window.location.href = "/AHCHelpdeskTest/Login/Index";
                        //location.reload();
                    },
                      error: function (ex) {
                          document.getElementById("loader").style.display = "none";
                        alert('Failed to retrieve models.' + ex);
                    }
                });
            }
            else { document.getElementById("loader").style.display = "none"; }
        }

function productchange() {
    var val = $('#ddlProducts').val();
    if (val == "other") {
        document.getElementById("div_productname").style.display = "block";
    }
    else {
        document.getElementById("div_productname").style.display = "none";
    }
}
         


 function isNumberKey(evt) {
    $('#txtmobileerror').text('');
    //var e = evt || window.event;
    var charCode = (evt.which) ? evt.which : evt.keyCode
    if (charCode != 46 && charCode > 31 && (charCode < 48 || charCode > 57))
        return false;
     $('#hdnMobileValidation').val('0');
     $("#txtmobilexxerror").html('');
    var myLength = $("#txtmobile").val().length;
    //alert(myLength);
    if (myLength > 21) {
        $("#txtmobilexxerror").after('<span id="txtmobileerror" style="color:red;" class="error">Maximum Lenght 20</span>');
        $('#hdnMobileValidation').val('1');
    }
    else if (myLength < 7) {
        $("#txtmobilexxerror").after('<span id="txtmobileerror" style="color:red;" class="error">Minimum Lenght 10</span>');
        $('#hdnMobileValidation').val('1');
    } else {
        $('#hdnMobileValidation').val('0');
    }

return true;
}

        function BindProducts() {
             document.getElementById("loader").style.display = "block";
             var companyid = 0;
              var roleid = $('#hdnRoleId').val();
             if (roleid == 501) {
                 companyid = $("#ddlCompany").val();
             }
             else {
                 companyid = $('#hdnCompanyId').val();
             }
             if (companyid == "") {
                   document.getElementById("loader").style.display = "none";
                 return false;
             }
             $.ajax({
                 type: 'POST',
                 url: '@Url.Action("GetProducts")', // we are calling json method
                 dataType: 'json',
                 data: { id: companyid },
                 success: function (data) {
                     debugger
                     var district = "<select id='ddlProducts' class='form-control kt-select2'>";
                     district = district + '<option value="0">--Select Products--</option>';
                     for (var i = 0; i < data.length; i++) {

                         district = district + '<option value=' + data[i].Value + '>' + data[i].Text + '</option>';
                     }
                     district = district + '</select>';
                     district = district + '<option value="other">Other</option>';
                     $('#ddlProducts').html(district);
                     document.getElementById("loader").style.display = "none";
                 },
                 error: function (ex) {
                     document.getElementById("loader").style.display = "none";
                     alert('Failed to retrieve Products.' + ex);
                 }
             });
            return false;
        }
    </script>
    <!--end::Page Scripts -->
</body>
</html>